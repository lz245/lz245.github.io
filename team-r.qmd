---
title: "Lab Team"
subtitle: "Meet the researchers driving our science"
toc: true
toc-depth: 2
---

```{r}
#| include: false
#| cache: false

library(yaml)
library(glue)
library(knitr)

# Read team data
team_data <- read_yaml("_data/team.yml")

# Function to create a profile card
create_card <- function(member, show_education = FALSE) {
  photo <- if (!is.null(member$photo) && member$photo != "") {
    glue('<img src="{member$photo}" alt="{member$name}" class="member-photo">')
  } else {
    '<div class="member-photo placeholder"><i class="bi bi-person-circle"></i></div>'
  }
  
  # Social links
  social_links <- c()
  if (!is.null(member$email)) {
    social_links <- c(social_links, glue('<a href="mailto:{member$email}" title="Email"><i class="bi bi-envelope"></i></a>'))
  }
  if (!is.null(member$orcid) && member$orcid != "") {
    social_links <- c(social_links, glue('<a href="https://orcid.org/{member$orcid}" title="ORCID"><i class="ai ai-orcid"></i></a>'))
  }
  if (!is.null(member$google_scholar) && member$google_scholar != "") {
    social_links <- c(social_links, glue('<a href="{member$google_scholar}" title="Google Scholar"><i class="ai ai-google-scholar"></i></a>'))
  }
  if (!is.null(member$github) && member$github != "") {
    social_links <- c(social_links, glue('<a href="https://github.com/{member$github}" title="GitHub"><i class="bi bi-github"></i></a>'))
  }
  
  social_html <- if (length(social_links) > 0) {
    paste0('<div class="member-social">', paste(social_links, collapse = " "), '</div>')
  } else ""
  
  # Education (for PI)
  edu_html <- ""
  if (show_education && !is.null(member$education)) {
    edu_items <- sapply(member$education, function(e) {
      glue('<li>{e$degree}, {e$institution}, {e$year}</li>')
    })
    edu_html <- glue('<div class="member-education"><strong>Education</strong><ul>{paste(edu_items, collapse = "")}</ul></div>')
  }
  
  # Research focus (for students)
  focus_html <- if (!is.null(member$research_focus) && member$research_focus != "") {
    glue('<p class="research-focus"><strong>Research:</strong> {member$research_focus}</p>')
  } else ""
  
  # Expected graduation
  grad_html <- if (!is.null(member$expected_graduation)) {
    glue('<p class="expected-grad"><em>Expected: {member$expected_graduation}</em></p>')
  } else ""
  
  glue('
<div class="member-card">
  <div class="member-photo-container">
    {photo}
  </div>
  <div class="member-info">
    <h3 class="member-name">{member$name}</h3>
    <p class="member-title">{member$title}</p>
    {focus_html}
    {grad_html}
    <p class="member-bio">{member$bio}</p>
    {edu_html}
    {social_html}
  </div>
</div>
')
}

# Function to create alumni card (simpler format)
create_alumni_card <- function(member) {
  photo <- if (!is.null(member$photo) && member$photo != "") {
    glue('<img src="{member$photo}" alt="{member$name}" class="alumni-photo">')
  } else {
    '<div class="alumni-photo placeholder"><i class="bi bi-person-circle"></i></div>'
  }
  
  thesis_html <- if (!is.null(member$thesis_title)) {
    glue('<p class="thesis"><em>Thesis: {member$thesis_title}</em></p>')
  } else ""
  
  position_html <- if (!is.null(member$current_position)) {
    glue('<p class="current-position"><strong>Now:</strong> {member$current_position}</p>')
  } else ""
  
  glue('
<div class="alumni-card">
  {photo}
  <div class="alumni-info">
    <strong>{member$name}</strong> ({member$graduation_year})<br>
    {member$title}
    {thesis_html}
    {position_html}
  </div>
</div>
')
}
```

## Principal Investigator

```{r}
#| output: asis
#| echo: false

for (member in team_data$principal_investigator) {
  cat(create_card(member, show_education = TRUE))
}
```

---

## Postdoctoral Researchers

```{r}
#| output: asis
#| echo: false

if (!is.null(team_data$postdocs) && length(team_data$postdocs) > 0) {
  cat('<div class="team-grid">')
  for (member in team_data$postdocs) {
    cat(create_card(member))
  }
  cat('</div>')
} else {
  cat('*No current postdocs. [Positions available!](join.qmd)*')
}
```

---

## Graduate Students

```{r}
#| output: asis
#| echo: false

if (!is.null(team_data$graduate_students) && length(team_data$graduate_students) > 0) {
  cat('<div class="team-grid">')
  for (member in team_data$graduate_students) {
    cat(create_card(member))
  }
  cat('</div>')
} else {
  cat('*We are recruiting graduate students! [Learn more](join.qmd)*')
}
```

---

## Undergraduate Researchers

```{r}
#| output: asis
#| echo: false

if (!is.null(team_data$undergraduate_students) && length(team_data$undergraduate_students) > 0) {
  cat('<div class="team-grid">')
  for (member in team_data$undergraduate_students) {
    cat(create_card(member))
  }
  cat('</div>')
} else {
  cat('*Interested in undergraduate research? [Contact us](join.qmd)*')
}
```

---

## Research Staff

```{r}
#| output: asis
#| echo: false

if (!is.null(team_data$staff) && length(team_data$staff) > 0) {
  cat('<div class="team-grid">')
  for (member in team_data$staff) {
    cat(create_card(member))
  }
  cat('</div>')
}
```

---
  
## Alumni

Our alumni have gone on to successful careers in academia, government, and industry.

```{r}
#| output: asis
#| echo: false

if (!is.null(team_data$alumni) && length(team_data$alumni) > 0) {
  cat('<div class="alumni-grid">')
  for (member in team_data$alumni) {
    cat(create_alumni_card(member))
  }
  cat('</div>')
}
```

---

## Lab Photos

::: {.lab-gallery}

![Lab group at ASM Microbe 2024](assets/images/lab-asm-2024.jpg){group="lab-photos" fig-alt="Lab group photo at conference"}

![Summer BBQ 2024](assets/images/lab-bbq-2024.jpg){group="lab-photos" fig-alt="Lab social event"}

![Sequencing in action](assets/images/lab-sequencing.jpg){group="lab-photos" fig-alt="MinION sequencing setup"}

:::

---

*Interested in joining our team? [See current opportunities](join.qmd)*
